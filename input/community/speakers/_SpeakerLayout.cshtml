@{
    Layout = @"_Layout.cshtml";
}

<section class="page-section">
    <div class="page-section_container container pt-0">
        <div class="page-section_row row h-100">
            <div class="page-section_column col-12 text-left pt-0">
                <article class="row">
                    <div class="col-md-3 bg-light p-5">
                        
                        <div class="text-center">
                            @if(Document.ContainsKey(SiteKeys.Image))
                            {
                                if (Document.GetString(SiteKeys.Image).StartsWith("http"))
                                {
                                    <img class="img-responsive contrib-logos mb-4" src="@Document.GetString(SiteKeys.Image)" alt="@Document.GetTitle()"/>
                                }
                                else
                                {
                                    <img class="img-responsive contrib-logos mb-4" src="assets/speakers/@Document.GetString(SiteKeys.Image)" alt="@Document.GetTitle()" />
                                }
                            }
                            else
                            {
                                <img class="img-responsive contrib-logos mb-4" src="img/dot_bot.png" alt="@Document.GetTitle()" />
                            }
                        </div>                        
                        
                        @if (Document.ContainsKey(SiteKeys.Location))
                        {
                            <div class="mb-4 font-weight-bold">@Document.GetString(SiteKeys.Location)</div>
                        }
                        @if (Document.ContainsKeys(SiteKeys.Lat, SiteKeys.Lon) && Context.ContainsKey(SiteKeys.AzureMapsSubscriptionKey))
                        {
                            <div id="speaker-map" class="mb-4"></div>
                        }

                        @if(Document.ContainsKey(SiteKeys.Tags))
                        {
                            <div class="mb-4">
                                <h3>Tags</h3>
                                @foreach(string tag in Document.GetList<string>(SiteKeys.Tags))
                                {
                                    <a href="/community/speakers?tag=@tag" class="btn btn-dark">@tag</a>  
                                }
                            </div>
                        }

                        @if(Document.ContainsKey("Connect"))
                        {
                            <div>
                                <h3>Connect</h3>
                                @foreach(IMetadata connect in Document.GetList<IMetadata>("Connect"))    
                                {
                                    <div><a href="@connect.GetString("Url")">@connect.GetString(WebKeys.Title)</a></div>
                                }
                            </div>
                        }
                    </div>
                    <div class="col-md-9 p-5">
                        <h1>@Document.GetTitle()</h1>
                        @RenderBody()
                    </div>
                </article>
            </div>
        </div>
    </div>
</section>

@if(Document.ContainsKeys(SiteKeys.Lat, SiteKeys.Lon) && Context.ContainsKey(SiteKeys.AzureMapsSubscriptionKey))
{
    <script>
        $(document).ready(function() {
            var map = new atlas.Map('speaker-map', {
                center: [@Document.GetString(SiteKeys.Lon), @Document.GetString(SiteKeys.Lat)],
                zoom: 1,
                language: 'en-US',
                authOptions: {
                    authType: 'subscriptionKey',
                    subscriptionKey: '@Context.GetString(SiteKeys.AzureMapsSubscriptionKey)'
                }});
            map.markers.add(new atlas.HtmlMarker({
                color: 'DodgerBlue',
                position: [@Document.GetString(SiteKeys.Lon), @Document.GetString(SiteKeys.Lat)]
            }));
        });
    </script>
}